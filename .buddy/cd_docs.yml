- pipeline: "CD Docs"
  on: "CLICK"
  refs:
  - "(^((?!master$).)*$)"
  priority: "NORMAL"
  ignore_fail_on_project_status: true
  fetch_all_refs: true
  fail_on_prepare_env_warning: true
  clone_depth: 1
  actions:
  - action: "Execute: yarn cd:docs"
    type: "BUILD"
    working_directory: "/buddy/ui-kit"
    docker_image_name: "library/node"
    docker_image_tag: "16.9.1-alpine3.14"
    cache_base_image: true
    setup_commands:
    - "yarn global add gatsby-cli"
    - "yarn install"
    execute_commands:
    - "yarn cd:docs"
    shell: "SH"
  - action: "Upload files to AWS S3/styleguide.landingi.com"
    type: "AMAZON_S3"
    input_type: "BUILD_ARTIFACTS"
    local_path: ".docz/public"
    bucket_name: "styleguide.landingi.com"
    acl: "PRIVATE"
    integration_hash: "5e7898d7422f5a0c56cb595e"
  - action: "Send notification to tech-frontend channel on success docs build"
    type: "SLACK"
    content: "[#$BUDDY_EXECUTION_ID] $BUDDY_PIPELINE_NAME execution by <$BUDDY_INVOKER_URL|$BUDDY_INVOKER_NAME> A new version of UI-KIT has been deployed"
    blocks: "[{\"type\":\"section\",\"fields\":[{\"type\":\"mrkdwn\",\"text\":\"*Successful execution:* <$BUDDY_EXECUTION_URL|Execution #$BUDDY_EXECUTION_ID $BUDDY_EXECUTION_COMMENT>\"},{\"type\":\"mrkdwn\",\"text\":\"*Pipeline:* <$BUDDY_PIPELINE_URL|$BUDDY_PIPELINE_NAME>\"},{\"type\":\"mrkdwn\",\"text\":\"*Branch:* $BUDDY_EXECUTION_BRANCH\"},{\"type\":\"mrkdwn\",\"text\":\"*Project:* <$BUDDY_PROJECT_URL|$BUDDY_PROJECT_NAME>\"}]}]"
    channel: "C010BBETC3E"
    channel_name: "tech-frontend"
    integration_hash: "5f4a2f2529a8af7df406ac85"
  - action: "Send notification to tech-deploy channel on failure"
    type: "SLACK"
    trigger_time: "ON_FAILURE"
    content: "[#$BUDDY_EXECUTION_ID] $BUDDY_PIPELINE_NAME execution by <$BUDDY_INVOKER_URL|$BUDDY_INVOKER_NAME> UI-KIT Docs build has been failed"
    blocks: "[{\"type\":\"section\",\"fields\":[{\"type\":\"mrkdwn\",\"text\":\"*Failed execution:* <$BUDDY_EXECUTION_URL|Execution #$BUDDY_EXECUTION_ID $BUDDY_EXECUTION_COMMENT>\"},{\"type\":\"mrkdwn\",\"text\":\"*Pipeline:* <$BUDDY_PIPELINE_URL|$BUDDY_PIPELINE_NAME>\"},{\"type\":\"mrkdwn\",\"text\":\"*Branch:* $BUDDY_EXECUTION_BRANCH\"},{\"type\":\"mrkdwn\",\"text\":\"*Project:* <$BUDDY_PROJECT_URL|$BUDDY_PROJECT_NAME>\"}]}]"
    channel: "C01ASVBDV9A"
    channel_name: "tech-deploy"
    integration_hash: "5f4a2f2529a8af7df406ac85"
  - action: "Send notification to tech-deploy channel on success"
    type: "SLACK"
    trigger_time: "ON_BACK_TO_SUCCESS"
    content: "[#$BUDDY_EXECUTION_ID] $BUDDY_PIPELINE_NAME execution by <$BUDDY_INVOKER_URL|$BUDDY_INVOKER_NAME> UI-KIT docs build succeeded"
    blocks: "[{\"type\":\"section\",\"fields\":[{\"type\":\"mrkdwn\",\"text\":\"*Successful execution:* <$BUDDY_EXECUTION_URL|Execution #$BUDDY_EXECUTION_ID $BUDDY_EXECUTION_COMMENT>\"},{\"type\":\"mrkdwn\",\"text\":\"*Pipeline:* <$BUDDY_PIPELINE_URL|$BUDDY_PIPELINE_NAME>\"},{\"type\":\"mrkdwn\",\"text\":\"*Branch:* $BUDDY_EXECUTION_BRANCH\"},{\"type\":\"mrkdwn\",\"text\":\"*Project:* <$BUDDY_PROJECT_URL|$BUDDY_PROJECT_NAME>\"}]}]"
    channel: "C01ASVBDV9A"
    channel_name: "tech-deploy"
    integration_hash: "5f4a2f2529a8af7df406ac85"
